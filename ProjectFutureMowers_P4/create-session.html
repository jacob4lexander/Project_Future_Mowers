<!DOCTYPE HTML> 
<html lang="en"> 
<head> 
<meta charset="utf-8"> 
<title>Create Session - Emma's Small Engines</title> 
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="css/style.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=PT+Serif:wght@400;700&display=swap" rel="stylesheet"> 
</head> 
<body onload="loadRepairData()">
	<header id="navigation" class="fixed-top animated-header">
		<div class="row">	
			<div class="column">
			  <h1 class="nav-link-home"><a href="index.html" tabindex="1">Emma's Small Engines</a></h1>
			</div>
			<div class="column">
				<nav class="navbar navbar-expand-lg navbar-dark">
			        <ul class="navbar-nav ml-auto text-center" id="nav">
			          	<li class="nav-item active">
			            	<a class="nav-link" href="index.html" tabindex="2">Home</a>
			          	</li>
						
			          	<li class="nav-item">
			            	<a class="nav-link" href="customer.html" tabindex="3">Customers</a>
			          	</li>
						
						<li class="nav-item">
                            <a class="nav-link" href="repair.html" tabindex="4">Repairs</a>
                        </li>
						
						<li class="nav-item">
                            <a class="nav-link" href="repair-session.html" tabindex="5">Sessions</a>
                        </li>
						
						<li class="nav-item">
                            <a class="nav-link" href="report-selection.html" tabindex="6">Reports</a>
                        </li>
						
						<li class="nav-item">
                            <a class="nav-link" href="help.html" tabindex="7">Help</a>
                        </li>
			        </ul>
			    </nav>
		  	</div>
		</div>
	</header>
	<main>
    <div class="spacer"></div>
		<div class="cu-shaded-rec">
		<div class="bread">
			<p>Home &#8594; Session &#8594; Create Repair Session</p>
		</div>
			<h2>Create Repair Session</h2>
			<nav class="navbar navbar-expand-lg navbar-dark">
				<ul class="link-center">
					<li class="nav-item active">
						<a class="nav-link" href="edit-session-dropdown-menus.html">Edit Dropdown Menus</a>
					</li>
				</ul>
			</nav>
			<div class="cu-container">
				<table class="smalltable" style="border-collapse: collapse;">
					<tr>
						<td style="padding-top: 20px;"><label for="sessionCustomer">Customer</label></td>
						<td style="padding-top: 20px;"><input type="text" id="sessionCustomer" name="sessionCustomer" title="Session customer" readonly></td>
					</tr>
					<tr>
						<td style="padding-top: 20px;"><label for="sessionSerial">Serial #</label></td>
						<td style="padding-top: 20px;"><input type="text" id="sessionSerial" name="sessionSerial" title="Session serial number" readonly>
					</tr>
					<tr>
						<td style="padding-top: 20px;"><label for="sessionStart">Session Start Time</label></td>
						<td style="padding-top: 20px;"><input class="crdateopen" type="datetime-local" id="inputDateOpen" name="dateopen" title="Date the repair is opened" onfocus="defaultDate('inputDateReceived')"></td>
					</tr>
					<tr>
						<td style="padding-top: 20px;"><label for="sessionEnd">Session End Time</label></td>
						<td style="padding-top: 20px;"><input class="crdateopen" type="datetime-local" id="inputDateClose" name="dateclose" title="Date the repair is opened" onfocus="defaultDate('inputDateReceived')"></td>
					</tr>
					<tr>
						<td style="padding-top: 20px;">Session Notes</td>
							<td style="padding-top: 20px;"><textarea name="inputdescription" id="notes" rows="6" class="textarearepair" title="Repair description input"></textarea>
						</td>
					</tr>
					<tr>
					    <td style="padding-top: 20px;">Session Complete</td>
					    <td style="padding-top: 20px;">
					    	<select class="crddl" id="complete" title="Service type dropdown menu" id="sessionComplete">
								<option value="" selected disabled>Not Selected</option>
						        <option value="Yes">Yes</option>
						        <option value="No">No</option>
						        
      						</select>
					    </td>
					</tr>
                    <tr>
					    <td style="padding-top: 20px;">Session Mechanic</td>
					    <td style="padding-top: 20px;">
					    	<select class="crddl" id="mechanic" title="Session Mechanic dropdown menu" id="sessionMechanic">
								<option value="" selected disabled>Not Selected</option>
						        <option value="Eugene">Eugene</option>
						        <option value="Sarah">Sarah</option>
      						</select>
					    </td>
					</tr>
					<tr>
					    <td style="padding-top: 20px;">Session Part</td>
					    <td style="padding-top: 20px;">
					    	<input type="search" id="part" name="Session Part Search Box" id="sessionPart" title="part search box">
							<button type="button" onclick="handleBtnSearch()" id="btnSearch">Search</button>	
					    </td>
					</tr>
					<tr>
						<td style="padding-top: 20px;"></td>
						<td style="padding-top: 20px;">
						<TextBox name="sessionPartText" id="sessionPartText"></TextBox>
						</td>
						
					</tr>
					
				</table>
			</div>
				<div class="row">
					<div class="column">
						<div class="reset-container">
							<button type="reset">Reset</button>
						</div>
					</div>
					<div class="column">
						<div class="submit-container">
							<button type="submit">Submit</button>
						</div>
					</div>
			</div>
			<nav class="navbar navbar-expand-lg navbar-dark">
				<ul class="link-center">
					<li class="nav-item active">
						<a class="nav-link" onclick="history.back()" tabindex="8">Return</a>
					</li>
				 </ul>
			</nav>
			<button name="btnPreLoad" onclick="handleBtnPreLoad()">0</button>	
		</div>
		<div class="spacer"></div>	
	</main>
	<footer>
		<small>Emma's Small Engines - JDAC Software - Final Prototype</small>
	</footer>
	<script>


		const parts = ["Engine", "Blade", "PCB", "Handle", "Wheel", "Gas Tank", "Axle"]

		function handleBtnSearch(){



		try{
		var partResult = document.getElementById("sessionPartText")
		partResult.innerHTML = searchStringInArray(sessionPart.value, parts).toString()

		}

		catch{
		var partResult = document.getElementById("sessionPartText")
		var errorMessage = "Part not found"
		partResult.innerHTML = errorMessage

		}

		}

		function searchStringInArray (str, strArray) 
		{
			for (var j=0; j<strArray.length; j++) 
				{
					if (strArray[j].match(str))
					
					
					{

						return parts[j];
					} 
					
				
				}
			return -1;
		}

		function handleBtnPreLoad(){

            document.getElementById('sessionCustomer').value = 'Alejandro Howell';
            document.getElementById('sessionSerial').value = 5433;
			docu

		};

		//QoL, make it so whenever the page is fully loaded, the received date is defaulted to todays date
		document.addEventListener("DOMContentLoaded",function(){
            defaultDate('inputDateOpen');
			defaultDate('inputDateClose');
        })
        //https://tecadmin.net/get-current-date-time-javascript/ 
        //gets the info passed to it, then sets the inputField to the date
        function defaultDate(inputId) {
            var inputField = document.getElementById(inputId); 

            //date constructor allowing us to hold todays date
            var date = new Date();

            //current date is converted into string format, and then only the first 10 characters are extracted
            // "YYYY-MM-DD" not taking hours/minutes because theres an offset of 5 hours or whatever it was. 
            var currentDate = date.toISOString().slice(0,10);

            //Then we get the hours and minutes. If the minutes is less than 10, add a zero before so it can format properly,
            // Then adding the actual minutes to the end. 
            var currentTime = date.getHours() + ":" + (date.getMinutes() < 10 ? '0' : '') + date.getMinutes()
            // Adds the date and time, "T" acts as a delimeter so it is able to read the date properly.
            inputField.value = currentDate + "T" + currentTime;
        }
		
		function handleBtnPreLoad() {
			
		}
	//Retrieved Passed DATA (coming as JSON so needs to be parsed)
		/*var sessionData = localStorage.getItem('sessionData')
		
		if(sessionData){
			//Turns data to an object so you can access the properties
			var sessionData = JSON.parse(sessionData)
			console.log(sessionData)

			//Filling text boxes and the values with the object data/properties
			document.getElementById('sessionStart').value = sessionData.sessionStart;
			document.getElementById('sessionEnd').value = sessionData.sessionEnd;
			document.getElementById('sessionComplete').value = sessionData.sessionComplete;
			document.getElementById('sessionMechanic').value = sessionData.sessionMechanic;
			document.getElementById('sessionPart').value = sessionData.sessionPart;

			//Save changes, get text box values and overrite local storage //CANT OVERRIDE HTML BECAUSE HARD CODED !
			document.getElementById('btnSubmit').addEventListener('click',function(){
				sessionData.sessionStart= document.getElementById('sessionStart').value;
                sessionData.sessionEnd= document.getElementById('sessionEnd').value;
                sessionData.sessionComplete= document.getElementById('sessionComplete').value;
                sessionData.sessionMechanic= document.getElementById('sessionMechanic').value;
                sessionData.sessionPart= document.getElementById('sessionPart').value;
                
				//Update the local storage item back to json to be saved
				localStorage.setItem('sessionData', JSON.stringify(sessionData))
				//Return user to equipment main page
				/*window.location.href = 'repair-session.html'*/
			
		
	</script>
</body> 
</html>